# Prompts Canonicalisés Vectora Inbox V2
# Date: 2026-02-02
# Scope: Generic normalization + Domain scoring
# Version: 2.0

# =============================================================================
# PROMPTS DE NORMALISATION
# =============================================================================

normalization:
  # DEPRECATED: lai_default prompt removed - use generic_normalization.yaml instead
  # Reason: Migrated to vertical-agnostic architecture (v2.0)
  # Date: 2026-02-02

# =============================================================================
# PROMPTS NEWSLETTER (Phase 2 - Placeholder)
# =============================================================================

newsletter:
  # TL;DR Generation - Génération du résumé exécutif
  tldr_generation:
    system_instructions: |
      You are an expert newsletter editor for biotech/pharma intelligence.
      Generate concise, executive-level TL;DR summaries for LAI (Long-Acting Injectable) technology newsletters.
      Focus on key trends, major developments, and strategic implications.
      
    user_template: |
      Generate a concise TL;DR (2-3 bullet points) for this week's LAI newsletter based on these items:

      {{items_summary}}

      Focus on:
      - Major partnerships or deals
      - Regulatory milestones
      - Clinical developments
      - Technology breakthroughs

      Format: Return only the TL;DR text, no additional formatting.
      Style: Executive, factual, concise.
      
    bedrock_config:
      max_tokens: 200
      temperature: 0.1
      anthropic_version: "bedrock-2023-05-31"

  # Introduction Generation - Génération de l'introduction
  introduction_generation:
    system_instructions: |
      You are an expert newsletter editor for biotech/pharma intelligence.
      Generate professional introductions for LAI (Long-Acting Injectable) technology newsletters.
      Keep it concise, informative, and executive-focused.
      
    user_template: |
      Generate a brief introduction (1-2 sentences) for this week's LAI newsletter.

      Week: {{week_start}} to {{week_end}}
      Sections covered: {{sections_summary}}
      Total items: {{total_items}}

      Focus on:
      - Brief context about the week's coverage
      - What executives should expect to learn

      Format: Return only the introduction text, no additional formatting.
      Style: Professional, executive-focused, concise.
      
    bedrock_config:
      max_tokens: 300
      temperature: 0.1
      anthropic_version: "bedrock-2023-05-31"

  # Section Summary Generation (optionnel MVP)
  section_summary:
    system_instructions: |
      You are an expert newsletter editor for biotech/pharma intelligence.
      Generate brief section summaries for LAI newsletter sections.
      
    user_template: |
      Generate a brief summary (1 sentence) for this newsletter section:

      Section: {{section_title}}
      Items: {{section_items}}

      Format: Return only the summary text.
      Style: Descriptive, factual.
      
    bedrock_config:
      max_tokens: 100
      temperature: 0.1
      anthropic_version: "bedrock-2023-05-31"

  # Title Reformulation (optionnel MVP)
  title_reformulation:
    system_instructions: |
      You are an expert newsletter editor for biotech/pharma intelligence.
      Reformulate news titles to be more engaging while preserving accuracy.
      
    user_template: |
      Reformulate this title to be more engaging:

      Original: {{original_title}}
      Context: {{item_summary}}

      Format: Return only the reformulated title.
      Style: Engaging but professional, preserve key information.
      
    bedrock_config:
      max_tokens: 50
      temperature: 0.2
      anthropic_version: "bedrock-2023-05-31"

# =============================================================================
# PROMPTS MATCHING/SCORING (Phase 2 - Placeholder)  
# =============================================================================

matching:
  # Prompt pour matching par domaines via Bedrock
  matching_watch_domains_v2:
    system_instructions: |
      You are a domain relevance expert for biotech/pharma intelligence.
      Evaluate how relevant a normalized news item is to specific watch domains.
      Focus on semantic understanding beyond keyword matching.
      Be precise and conservative in your evaluations.
      
    user_template: |
      Evaluate the relevance of this normalized item to the configured watch domains:

      ITEM TO EVALUATE:
      Title: {{item_title}}
      Summary: {{item_summary}}
      Entities: {{item_entities}}
      Event Type: {{item_event_type}}

      WATCH DOMAINS TO EVALUATE:
      {{domains_context}}

      For each domain, evaluate:
      1. Is this item relevant to the domain's focus area?
      2. What is the relevance score (0.0 to 1.0)?
      3. What is your confidence level (high/medium/low)?
      4. Which entities contributed to the match?
      5. Brief reasoning for the evaluation

      EVALUATION CRITERIA:
      - Consider semantic context, not just keyword presence
      - Technology domains require clear technology signals
      - Regulatory domains focus on approvals, submissions, compliance
      - Company relevance should match the domain's scope
      - Be conservative: prefer false negatives over false positives

      RESPONSE FORMAT (JSON only):
      {
        "domain_evaluations": [
          {
            "domain_id": "...",
            "is_relevant": true/false,
            "relevance_score": 0.0-1.0,
            "confidence": "high/medium/low",
            "reasoning": "Brief explanation (max 2 sentences)",
            "matched_entities": {
              "companies": [...],
              "molecules": [...],
              "technologies": [...],
              "trademarks": [...]
            }
          }
        ]
      }

      Respond with ONLY the JSON, no additional text.
      
    bedrock_config:
      max_tokens: 1500
      temperature: 0.1
      anthropic_version: "bedrock-2023-05-31"
  
  # Placeholder pour scoring de pertinence (futur)
  relevance_scoring:
    system_instructions: |
      # TBD Phase 3
      You are a relevance scoring expert for LAI technologies.
      
    user_template: |
      # TBD Phase 3 - Prompt de scoring de pertinence
      
    bedrock_config:
      max_tokens: 500
      temperature: 0.1
      anthropic_version: "bedrock-2023-05-31"

# =============================================================================
# MÉTADONNÉES
# =============================================================================

metadata:
  version: "1.0"
  created_date: "2025-12-12"
  last_modified: "2025-12-12"
  scope: "normalization_lai_and_newsletter"
  description: |
    Prompts canonicalisés V1 pour Vectora Inbox.
    Phase 1: Normalisation LAI uniquement.
    Phase 2A: Extension newsletter (IMPLÉMENTÉ).
    Phase 2B: Extension matching/scoring (N/A - pas de prompts Bedrock).
  
  # Changelog pour traçabilité
  changelog:
    - version: "2.0"
      date: "2026-02-02"
      changes: "Architecture v2.0 - Removed lai_default prompt (deprecated), migrated to generic_normalization.yaml"
    - version: "1.2"
      date: "2025-12-16"
      changes: "Ajout prompt matching_watch_domains_v2 pour matching Bedrock par domaines"
    - version: "1.1"
      date: "2025-12-12"
      changes: "Phase 2A - Migration prompt newsletter éditorial depuis bedrock_client.py"
    - version: "1.0"
      date: "2025-12-12"
      changes: "Création initiale - Migration prompt normalisation LAI depuis code hardcodé"