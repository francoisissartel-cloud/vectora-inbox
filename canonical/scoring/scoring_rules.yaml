# Règles de scoring métier pour Vectora Inbox.
# Ces poids et facteurs guident le calcul du score de pertinence de chaque item
# avant sa sélection dans la newsletter.
#
# Idée générale : un bon signal (clinique / réglementaire, sur un domaine prioritaire,
# impliquant un compétiteur ou une molécule clé, récent et issu d'une bonne source)
# doit naturellement remonter en tête de la liste.

event_type_weights:
  # Poids relatifs par type d'évènement.
  # Valeurs plus élevées = événements plus importants pour la veille.
  # Ces valeurs pourront être ajustées plus tard selon le ressenti des utilisateurs.

  clinical_update: 5          # Résultats, débuts/fins d'étude : cœur de la veille.
  regulatory: 5               # Approvals, CRL, mises à jour de label : hyper stratégique.
  partnership: 6              # Deals, licensing, co-développement : très important.
  corporate_move: 2           # Changements de management, restructuration : signal utile mais secondaire.
  financial_results: 3        # Contexte business, mais moins ciblé que le clinique/réglementaire.
  scientific_publication: 3   # Publications scientifiques importantes, plutôt "background" stratégique.
  other: 1                    # Autres évènements : faible priorité par défaut.

domain_priority_weights:
  # Poids par priorité de domaine (high > medium > low).
  # Reflète l'importance stratégique des domaines suivis pour un client donné.

  high: 3     # Domaines "core" pour le client.
  medium: 2   # Domaines importants mais pas critiques.
  low: 1      # Domaines périphériques.

other_factors:
  # Bonus ou facteurs additionnels modulant le score.

  # Bonus si l'item mentionne un compétiteur clé du client.
  competitor_company_bonus: 2

  # Bonus si l'item mentionne une molécule / produit clé pour le client.
  key_molecule_bonus: 1.5

  # Demi-vie de décroissance pour la récence (en jours).
  # Exemple : avec une demi-vie de 7 jours, l'impact de la récence est divisé par 2
  # au bout d'une semaine.
  recency_decay_half_life_days: 7

  # Bonus pour la "profondeur" du signal (nombre d'entités pertinentes détectées).
  # Par exemple, la Lambda de scoring peut ajouter +0.3 par entité pertinente
  # au-delà de la première.
  signal_depth_bonus: 0.3

  # Poids par type de source.
  # Corporate = communiqué officiel / site de l'entreprise.
  # Sector = presse spécialisée (FiercePharma, Endpoints, etc.).
  # Generic = sources plus généralistes ou moins ciblées.

  source_type_weight_corporate: 2
  source_type_weight_sector: 1.5
  source_type_weight_generic: 1

  # Bonus pour les pure players (défini par un scope canonical).
  # Le scope référencé doit exister dans canonical/scopes/company_scopes.yaml
  # RÉDUIT de 1.5 à 1.0 pour éviter que les pure players sans signaux LAI dominent
  pure_player_bonus: 1.0
  pure_player_scope: "lai_companies_mvp_core"  # Référence à un scope
  
  # NOUVEAU : Bonus si contexte LAI implicite pour pure players
  pure_player_context_bonus: 3.0
  
  # Bonus signaux LAI explicites (augmentés)
  technology_bonus: 4.0               # Augmenté
  molecule_bonus: 4.0                 # Augmenté
  trademark_bonus: 5.0                # Augmenté (déjà présent à 0.5, maintenant 5.0)
  regulatory_bonus: 6.0               # Augmenté pour UZEDY type
  
  # NOUVEAU : Malus anti-LAI
  oral_route_penalty: -10             # Pénalité route orale

  # Match confidence multipliers (nouveau - Phase 3)
  # Multiplie le base_score selon la confiance du matching
  match_confidence_multiplier_high: 1.5
  match_confidence_multiplier_medium: 1.2
  match_confidence_multiplier_low: 1.0

  # Signal quality weights (nouveau - Phase 3)
  # Bonus par signal matché selon la catégorie
  signal_quality_weight_high_precision: 2.0
  signal_quality_weight_supporting: 1.0
  signal_quality_weight_context: 0.5

  # Negative term penalty (nouveau - Phase 3)
  # Pénalité si negative_terms détectés
  negative_term_penalty: 10

  # Bonus pour les hybrid companies (nouveau - Phase 3)
  # Bonus réduit pour les big pharma/mid pharma avec activité LAI
  hybrid_company_bonus: 1
  hybrid_company_scope: "lai_companies_hybrid"

  # Domain relevance scoring (nouveau - LLM gating)
  # Pénalité si aucune évaluation domain_relevance disponible
  no_domain_relevance_penalty: 0.1
  # Pénalité si aucun domaine n'est jugé pertinent
  no_relevant_domain_penalty: 0.2
  # Bonus pour les trademarks détectées (remplacé par valeur plus haut)
  # trademark_bonus: 0.5  # Remplacé par trademark_bonus: 5.0 plus haut

# PHASE 4: Scoring contextuel par type de company
contextual_scoring:
  pure_players:
    base_bonus: 2.0
    context_multipliers:
      regulatory_milestone: 3.0      # UZEDY approvals
      partnership_bigpharma: 2.5     # Nanexa/Moderna
      grant_funding: 2.0             # MedinCell malaria
      clinical_update: 2.0
      
  hybrid_companies:
    base_bonus: 1.0
    require_explicit_lai: true
    
  unknown_companies:
    base_bonus: 0.5
    require_strong_lai: true

# Pénalités contextuelles
contextual_penalties:
  hr_content: -5.0
  financial_only: -3.0
  conference_only: -2.0
  anti_lai_route: -10.0

# Nouveaux bonus contextuels
contextual_bonuses:
  partnership_announcement: 5.0    # Nanexa/Moderna type
  regulatory_milestone: 5.0        # UZEDY approval type
  grant_innovation: 3.0            # MedinCell malaria type
  trademark_mention: 6.0           # UZEDY dans titre

# Nouvelles pénalités contextuelles
contextual_penalties:
  hr_recruitment: -6.0             # "hiring", "seeks"
  financial_reporting: -6.0        # "financial results", "interim report"
  corporate_appointments: -6.0     # "appoints", "chief officer"
  conference_participation: -6.0   # "present at", "participate in"

# Bonus récence pour signaux forts
recency_bonuses:
  regulatory_milestone:
    0_7_days: 2.0
    8_30_days: 1.0
    
  partnership_announcement:
    0_7_days: 1.5
    8_30_days: 0.5

# Seuils de sélection pour la newsletter.
# Ces seuils déterminent quels items seront inclus dans la newsletter finale.
selection_thresholds:
  # Score minimum pour qu'un item soit inclus dans la newsletter.
  # Les items avec un score inférieur à ce seuil sont exclus.
  # AUGMENTÉ de 5 à 8 pour filtrer le bruit HR/Finance
  min_score: 8

  # Nombre minimum d'items par section.
  # Si une section a moins de X items au-dessus du seuil min_score,
  # on inclut quand même les X meilleurs items de cette section
  # (même s'ils sont en dessous du seuil).
  # Cela garantit qu'une section ne soit jamais complètement vide.
  min_items_per_section: 1
